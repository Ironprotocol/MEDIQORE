<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MEDIQORE - Hospital</title>
    <!-- Google Fonts 추가 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/hospital/sidebar1.css">
    <link rel="stylesheet" href="css/hospital/sidebar2.css">
    <link rel="stylesheet" href="css/hospital/topbar.css">
    <link rel="stylesheet" href="css/hospital/registration.css">
    <link rel="stylesheet" href="css/hospital/desk.css">
    <link rel="stylesheet" href="css/hospital/calendar.css">
    <link rel="stylesheet" href="css/hospital/tooltip_calendar.css">
    <link rel="stylesheet" href="css/hospital/common.css">
    <link rel="stylesheet" href="css/hospital/prescription.css">
    <link rel="stylesheet" href="css/hospital/prescription_canvas.css">
    <link rel="stylesheet" href="css/hospital/prescription-payment.css">
    <link rel="stylesheet" href="css/hospital/data-menu.css">
    <link rel="stylesheet" href="css/hospital/qrcode.css">

    <!-- D3.js 라이브러리 추가 -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <!-- QR Code Styling 라이브러리 추가 -->
    <script type="text/javascript" src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
</head>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            font-family: 'Noto Sans KR', sans-serif;  /* 기본 글씨체 설정 */
            background-color: rgb(201, 214, 255);  /* 기본 배경색 설정 */
            user-select: none;  /* 텍스트 선택 비활성화 */
            -webkit-user-select: none;  /* Safari용 */
            -moz-user-select: none;  /* Firefox용 */
            -ms-user-select: none;  /* IE용 */
        }
    </style>
    <script type="module">
        import {app, auth, db, doc, getDoc, setDoc, collection, query, where, getDocs, updateDoc,  serverTimestamp, Timestamp,onSnapshot,orderBy } from './js/firebase-config.js';
        import {setupCloseButtons, setupLogoLogout, initializeStatusSelector, initializeZoomPrevention, displayUserName, initializeUserName, synchronizeUserState} from './js/hospital/common.js';
        import {checkUserPermissions, initializeMenuEvents, initializeHomePage} from './js/hospital/desk-menu.js';
        import {initializePatientList} from './js/hospital/patient-list.js';
        import {initializeRoomManagement, handleRoomLogout} from './js/hospital/room.js';
        import {initializeSubmenuEvents, initializeSubmenuItemEvents } from './js/hospital/sidebar2.js';
        import {CustomCalendar,initializeScheduler} from './js/hospital/calendar.js';
        import {handleComplaintChange, initializeNewPatientButton, loadDoctors, initializeAddressSearch, initializeInsuranceForm, initializeRegistrationForm} from './js/hospital/patient-registration.js';
        import {initializePrescription} from './js/hospital/prescription.js';
        import {initializeDataMenu} from './js/hospital/data-menu.js';
        import {initializePrescriptionPayment} from './js/hospital/prescription-payment.js';
        import {initializePatientEdit} from './js/hospital/patient-edit.js';
        import {initializePatientView} from './js/hospital/patient-view.js';
        import {initializeTopBar} from './js/hospital/topbar.js';

        // 전역 함수
        window.app = app;
        window.auth = auth;
        window.db = db;
        window.doc = doc;
        window.getDoc = getDoc;
        window.setDoc = setDoc;
        window.collection = collection;
        window.query = query;
        window.where = where;
        window.getDocs = getDocs;
        window.updateDoc = updateDoc;
        window.serverTimestamp = serverTimestamp;
        window.Timestamp = Timestamp;  // Timestamp를 window 객체에 추가

            // 의사 상태 아이콘 설정 수정
            const statusIcons = {
                login: 'image/login.png',
                start: 'image/start.png',
                end: 'image/logout.png',
                break: 'image/break.png'
                };
                
            // UI 요소 생성
            const actionButtons = document.querySelector('.action-buttons');
            if (actionButtons) {
                  actionButtons.innerHTML = `
                      <button class="action-button" id="refresh-button">
                          <img src="image/update.png" alt="Update" title="Refresh" class="update-icon">
                      </button>
                      <button class="action-button" id="chat-button">
                          <img src="image/chat_black.png" alt="Chat" title="Chat" class="chat-icon" style="width: 25px; height: 19.725px;">
                      </button>
                      <span class="user-name"></span>
                      <div class="status-selector">
                          <div class="current-status">
                              <img src="image/login.png" alt="Status" class="status-icon">
                          </div>
                          <div class="status-dropdown">
                              <div class="status-option" data-status="end">
                                  <img src="image/logout.png" alt="End Work" class="status-icon">
                                  <span>End</span>
                              </div>
                              <div class="status-option" data-status="break">
                                  <img src="image/break.png" alt="Break" class="status-icon">
                                  <span>Break</span>
                              </div>
                          </div>
                      </div>
                  `;
                }

            initializeNewPatientButton(); // New patient 버튼 초기화
            initializeUserName();       //common.js - 우측 상단 의사 이름 초기화
            initializeStatusSelector(); //common.js - 우측 상단 의사 상태 초기화

            // chat 버튼에 마우스 오버/아웃 이벤트 추가
            const chatButton = document.getElementById('chat-button');
            if (chatButton) {
                const chatIcon = chatButton.querySelector('.chat-icon');
                chatButton.addEventListener('mouseover', () => {
                    chatIcon.src = 'image/chat.png';
                });
                chatButton.addEventListener('mouseout', () => {
                    chatIcon.src = 'image/chat_black.png';
                });
            }

            let roomUnsubscribe = null;

            auth.onAuthStateChanged(async (user) => {
                    if (!user) {
                        if (roomUnsubscribe) {
                            roomUnsubscribe();
                        }
                        window.location.href = 'main.html';
                        return;
                    } //회원 아니면 돌려보냄
         
            // 사용자 상태 동기화 추가
            await synchronizeUserState(user);
            
            try {
              await checkUserPermissions(user);
              const hospitalName = user.email.split('@')[0].split('.')[0]; // hospitalName 추출
              const currentDate = document.querySelector('.current-date').textContent; // 현재 날짜 가져오기
              await initializePatientList(hospitalName, currentDate); //patient-list.js - 환자 리스트 전체 관리
              roomUnsubscribe = await initializeRoomManagement(hospitalName);
              initializePrescription();  // Prescription 초기화
                
              auth.onAuthStateChanged(async (user) => {
                    if (!user) {
                       await handleRoomLogout();  // room - 로그아웃 감지 및 처리를 위한 추가 리스너
                    }
                    });
                    } 
                    catch (error) {
                        console.error('Error:', error);
                            alert('Error loading user permissions. Please try again.');
                            await auth.signOut();
                        window.location.href = 'main.html';
                    }
            initializeSubmenuEvents()
            initializeSubmenuItemEvents(); // sidebar2 - submenu 클릭 이벤트 처리
            });        
            setupCloseButtons();           //닫기 버튼 기능    
            setupLogoLogout();             // 로고 클릭 이벤트 설정
            initializeTopBar();            // 탑바 초기화 (update 버튼 등)

            // 환자 등록 - patient registration
            initializeAddressSearch();
            initializeInsuranceForm();
            initializeRegistrationForm();
            initializeMenuEvents();     // 메뉴 클릭 시 - sidebar1 메뉴 항목 조정
            initializeHomePage();       // Home 페이지 초기화 (시작 시 Home 컨텐츠 표시)

            function updateDate() {
                const today = new Date();
                const day = String(today.getDate()).padStart(2, '0');
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                const month = months[today.getMonth()];
                const year = today.getFullYear();
                const formattedDate = `${day}.${month}.${year}`;
                document.querySelector('.current-date').textContent = formattedDate;
                }
            
            updateDate();               // 페이지 로드 시 날짜 업데이트
            initializeZoomPrevention(); // 확대/축소 방지 기능 초기화
            initializeScheduler();

            initializeDataMenu();
            initializePrescriptionPayment(); // Prescription Payment 초기화
            initializePatientEdit(); // 환자 정보 수정 기능 초기화
            initializePatientView(); // 환자 방문 기록 조회 기능 초기화

    </script>
    <script>
        // CSS 캐시 무효화 - 페이지 로드 시 실행
        document.addEventListener('DOMContentLoaded', function() {
            // 모든 CSS 링크에 대해
            const cssLinks = document.querySelectorAll('link[rel="stylesheet"]');
            cssLinks.forEach(link => {
                // 현재 href 가져오기
                const currentHref = link.getAttribute('href');
                // 캐시 방지를 위한 랜덤 쿼리 파라미터 추가
                const newHref = currentHref + (currentHref.includes('?') ? '&' : '?') + '_=' + new Date().getTime();
                // 새 href 설정
                link.setAttribute('href', newHref);
            });
        });
    </script>
</head>
<body>
    <div class="sidebar1">
        <div class="logo-container">
            <img src="image/text_logo.png" alt="MEDIQORE Logo" class="logo-image">
            
        </div>
        <div class="menu-container">
            <div class="menu-item">
                <img src="image/home_black.png" alt="Home" class="menu-icon menu-icon-default">
                <img src="image/home.png" alt="Home" class="menu-icon menu-icon-active">
                Home
            </div>
            <div class="menu-item menu-item-desk" id="desk-menu">
                <img src="image/desk_black.png" alt="desk" class="menu-icon menu-icon-default">
                <img src="image/desk.png" alt="desk" class="menu-icon menu-icon-active">
                Desk
            </div>
            <div class="menu-item">
                <img src="image/prescription_black.png" alt="Prescription" class="menu-icon menu-icon-default">
                <img src="image/prescription.png" alt="Prescription" class="menu-icon menu-icon-active">
                Prescription
            </div>
            <div class="menu-item">
                <img src="image/reservation_black.png" alt="Reservation" class="menu-icon menu-icon-default">
                <img src="image/reservation.png" alt="Reservation" class="menu-icon menu-icon-active">
                Reservation
            </div>
            <div class="menu-item menu-item-data" id="data-menu">
                <img src="image/data_black.png" alt="data" class="menu-icon menu-icon-default">
                <img src="image/data.png" alt="data" class="menu-icon menu-icon-active">
                Data
            </div>
        </div>
        <div class="version-container">
            <div class="divider"></div>
            <div class="version-info">v.0.5 test</div>
        </div>
    </div>
    <div class="top-bar">
        <div class="page-title">Chart</div>
        <div class="search-form">
            <input type="text" class="search-input" placeholder="Patient Search">
        </div>
        <button class="new-patient-btn" title = 'Add a new patient'>
            New Patient <span class="plus-sign">+</span>

        </button>
        <div class="action-buttons">
            <button class="action-button" id="refresh-button">
                <img src="image/update.png" alt="Update" title="Refresh" class="update-icon">
            </button>
            <button class="action-button" id="chat-button">
                <img src="image/chat_black.png" alt="Chat" title="Chat" class="chat-icon" style="width: 20px; height: 15.78px;">
            </button>
            <span class="user-name"></span>
            <div class="status-selector">
                <div class="current-status">
                    <img src="image/login.png" alt="Status" class="status-icon">
                </div>
                <div class="status-dropdown">
                    <div class="status-option" data-status="end">
                        <img src="image/logout.png" alt="End Work" class="status-icon">
                        <span>End</span>
                    </div>
                    <div class="status-option" data-status="break">
                        <img src="image/break.png" alt="Break" class="status-icon">
                        <span>Break</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="sidebar2">
        <div class="patient-list-title">Treatment progress list</div>
        <div class="submenu-container">
            <div class="submenu-item active">Examine</div>
            <div class="submenu-item">Done</div>
            <div class="submenu-item">Chat</div>
        </div>

        <div class="patient-list-container">
            <!-- Room/Desk UI가 여기에 동적으로 추가됨 -->
        </div>

        <!-- Done 컨테이너 -->
        <div class="done-list-container">
            <!-- Done 목록이 여기에 추가될 것임 -->
        </div>

        <!-- Memo 컨테이너 -->
        <div class="chat-list-container">
            <!-- chat 목록이 여기에 추가될 것임 -->
        </div>

        <div class="bottom-container">
            <!-- 하단 컨테이너 내용 -->
        </div>
    </div>
    <div class="main-content-prescription">
        <div id="prescription-content" class="content-container-prescription">
            <div class="content-header-prescription">
                <div class="content-title-prescription">Prescription</div>
            </div>

            <!-- 100% 너비의 메시지 컨테이너 -->
            <div class="patient-select-wrapper">
                <div class="patient-select-message">
                    No patient records found. Please select a patient from the list.
                </div>
            </div>

            <!-- 기존 레이아웃 (초기에 숨김) -->
            <div class="content-body-prescription" style="display: none;">
                <div class="prescription-layout">
                    <div class="prescription-left-container">
                        <div class="prescription-left-title">Prescript History</div>
                    </div>
                    
                    <div class="prescription-center-container">
                        <div class="prescription-center-top">
                            <div class="prescription-section-title">Medical Records</div>
                            <div class="tooth-chart-container">
                                <img src="image/tooth.svg" alt="Dental Chart" class="tooth-chart-img">
                                <canvas class="tooth-chart-canvas"></canvas>
                                <svg class="tooth-chart-svg"></svg>
                            </div>
                        </div>
                        <div class="prescription-center-bottom">
                            <div class="prescription-section-title">Diagnosis & Prescription</div>
                            <button class="prescription-favorite-btn" title="Add to order set"></button>
                        </div>
                    </div>
                         <!-- 오른쪽 컨테이너 (4번) -->
                         <div class="content-body-prescription2">
                            <div class="prescription-right-top-area">
                                <div class="prescription-section-title">Image</div>
                                <button class="attach-image-btn" title="Add to image"></button>
                            </div>
                            <div class="prescription-right-bottom-area">
                                <div class="prescription-section-title">Order set</div>
                                <input type="text" class="order-set-search-input" placeholder="Search order set">
                            </div>
                        </div>
                </div>
            </div>
            <div class="content-footer-prescription" style="display: none;">
                <button class="new-chart-btn"  title = "Open a new chart">
                    <img src="image/new_chart.png" alt="New Chart Icon">
                    New Chart
                </button>
                <span class="current-room-name"></span>
            </div>
        </div>
    </div>
    <div class="main-content">
        <div id="data-content" class="content-container data-container">
            <div class="content-header">
                <div class="content-title">Hospital Data Center</div>
            </div>
            <div class="content-body">
                <div class="data-content-wrapper">
                    <!-- 검색 및 필터 영역 -->
                    <div class="data-search-filter-container">
                        <!-- 검색 입력폼 -->
                        <div class="data-search-container">
                            <input type="text" id="data-search" placeholder="Search Data" class="data-search-input">
                        </div>
                        
                        <!-- 필터 버튼들 -->
                        <div class="data-filter-container">
                            <button class="data-filter-btn active" data-type="patients">
                                Patient
                            </button>
                            <button class="data-filter-btn" data-type="staff">
                                Staff
                            </button>
                            <button class="data-filter-btn" data-type="daily">
                                <img src="image/history.png" alt="Daily" class="daily-icon"> Daily
                            </button>
                        </div>
                    </div>
                    
                    <!-- 데이터 표시 영역 (테이블 형식) -->
                    <div id="data-display-area">
                        <!-- 환자 데이터 테이블 -->
                        <table id="patient-data-table" class="data-table">
                            <thead>
                                <tr class="data-table-header">
                                    <th class="data-table-th">Name</th>
                                    <th class="data-table-th">ID</th>
                                    <th class="data-table-th">Gender</th>
                                    <th class="data-table-th">Birth</th>
                                    <th class="data-table-th">Phone</th>
                                    <th class="data-table-th">Address</th>
                                    <th class="data-table-th">Insurance</th>
                                    <th class="data-table-th">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="patient-data-body">
                                <!-- 데이터는 JavaScript로 동적 생성됩니다 -->
                                <tr>
                                    <td colspan="8" class="loading-message">Loading patient data...</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <!-- 스태프 데이터 테이블 (기본적으로 숨김) -->
                        <table id="staff-data-table" class="data-table" style="display: none;">
                            <thead>
                                <tr class="data-table-header">
                                    <th class="data-table-th">Name</th>
                                    <th class="data-table-th">Role</th>
                                    <th class="data-table-th">Email</th>
                                    <th class="data-table-th">Phone</th>
                                    <th class="data-table-th">Status</th>
                                    <th class="data-table-th">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="staff-data-body">
                                <!-- 데이터는 JavaScript로 동적 생성됩니다 -->
                                <tr>
                                    <td colspan="6" class="loading-message">Loading staff data...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- 페이지네이션을 footer 영역으로 이동 -->
                    <div class="data-content-footer">
                        <div id="pagination-controls">
                            <!-- 페이지네이션 버튼은 JavaScript로 동적 생성됩니다 -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="patient-registration-content" class="content-container">
            <div class="content-header">
                <div class="content-title">Patient Registration</div>
                <button class="reset-btn"><img src="image/reset.png" alt="Reset"></button>
            </div>
            <div class="vertical-line-left"></div>
            <div class="vertical-line-right"></div>
            <div class="patient-registration-form">
                <div class="form-container">
                    <div class="section-box">
                        <h3>Personal Information</h3>
                        <div class="form-group">
                            <label for="idNumber">ID Card / Passport number</label>
                            <div class="id-input-wrapper">
                                <input type="text" id="idNumber" name="idNumber" required>
                                <button type="button" class="id-check-btn">Check</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="patientName">Patient Name</label>
                            <input type="text" id="patientName" name="patientName" required>
                        </div>
                        <div class="form-group">
                            <label for="phoneNumber">Cell Phone Number</label>
                            <input type="text" id="phoneNumber" name="phoneNumber">
                        </div>
                        <div class="form-group">
                            <label for="gender">Gender</label>
                            <select id="gender" name="gender" required>
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="birthDay">Birth Date</label>
                            <div class="date-select-group">
                                <select id="birthDay" name="birthDay" required>
                                    <option value="">Day</option>
                                    <script>
                                        for(let i = 1; i <= 31; i++) {
                                            document.write(`<option value="${i}">${i}</option>`);
                                        }
                                    </script>
                                </select>
                                <select id="birthMonth" name="birthMonth" required>
                                    <option value="">Month</option>
                                    <option value="1">Jan</option>
                                    <option value="2">Feb</option>
                                    <option value="3">Mar</option>
                                    <option value="4">Apr</option>
                                    <option value="5">May</option>
                                    <option value="6">Jun</option>
                                    <option value="7">Jul</option>
                                    <option value="8">Aug</option>
                                    <option value="9">Sep</option>
                                    <option value="10">Oct</option>
                                    <option value="11">Nov</option>
                                    <option value="12">Dec</option>
                                </select>
                                <select id="birthYear" name="birthYear" required>
                                    <option value="">Year</option>
                                    <script>
                                        const currentYear = new Date().getFullYear();
                                        for(let i = currentYear; i >= currentYear - 100; i--) {
                                            document.write(`<option value="${i}">${i}</option>`);
                                        }
                                    </script>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="district">Address</label>
                            <div class="address-details">
                                <input type="text" id="district" name="district" placeholder="District">
                                <input type="text" id="city" name="city" placeholder="City">
                                <input type="text" id="state" name="state" placeholder="State">
                                <div id="addressResults" class="address-results"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="primaryComplaint">Primary Complaint</label>
                            <select id="primaryComplaint" name="primaryComplaint" required>
                                <option value="">Select primary complaint</option>
                                <option value="toothache">Toothache</option>
                                <option value="sensitivity">Tooth Sensitivity</option>
                                <option value="bleeding_gums">Bleeding Gums</option>
                                <option value="swollen_gums">Swollen Gums</option>
                                <option value="bad_breath">Bad Breath</option>
                                <option value="loose_tooth">Loose Tooth</option>
                                <option value="cavity">Cavity/Decay</option>
                                <option value="broken_tooth">Broken/Chipped Tooth</option>
                                <option value="wisdom_tooth">Wisdom Tooth Pain</option>
                                <option value="jaw_pain">Jaw Pain</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="form-group" id="otherComplaintContainer" style="display: none;">
                            <label for="otherComplaint">Specify Other Complaint</label>
                            <textarea id="otherComplaint" name="otherComplaint" 
                                    style="height: 84px; resize: none;"></textarea>
                        </div>
                    </div>
                    <div class="section-box">
                        <h3>Insurance Information</h3>
                        <div class="form-group">
                            <div class="checkbox-group">
                                <input type="radio" id="hasInsurance" name="insuranceStatus" value="has">
                                <label for="hasInsurance">Have Medical Insurance</label>
                            </div>
                            <div class="checkbox-group">
                                <input type="radio" id="noInsurance" name="insuranceStatus" value="none">
                                <label for="noInsurance">No Insurance</label>
                            </div>
                        </div>
                        <div class="insurance-details" style="display: none;">
                            <div class="form-group">
                                <label for="insuranceProvider">Insurance Provider</label>
                                <select id="insuranceProvider" name="insuranceProvider">
                                    <option value="">Select insurance provider</option>
                                    <option value="discovery">Discovery Health</option>
                                    <option value="momentum">Momentum Health</option>
                                    <option value="bonitas">Bonitas Medical Fund</option>
                                    <option value="medihelp">Medihelp</option>
                                    <option value="fedhealth">Fedhealth</option>
                                    <option value="medshield">Medshield</option>
                                    <option value="bestmed">Bestmed</option>
                                    <option value="keyhealth">KeyHealth</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="insuranceNumber">Insurance Card Number</label>
                                <input type="text" id="insuranceNumber" name="insuranceNumber">
                            </div>
                        </div>
                    </div>
                    <div class="section-box">
                    </div>
                </div>
            </div>
            <div class="content-footer">
                <button class="register-btn">
                    <img src="image/register.png" alt="Register Icon">
                    Register
                </button>
            </div>
        </div>



        <!--------------------------------------------------- Desk 메뉴용 컨테이너 -------------------------------------------------------------->
        <div id="desk-content" class="content-container desk-container">
            <!-- 헤더 영역 -->
            <div class="content-header">
                <div class="content-title">
                    Patient List
                    <span class="current-date"></span>
                </div>
                <button class="close-button">Close</button>
            </div>

            <!-- 중간 컨테이너 -->
            <div class="content-body">
            </div>

            <!-- 하단 컨테이너 -->
            <div class="content-footer">
            </div>
        </div>

        <div id="desk-content-right" class="content-container-2 desk-container-right">
            <div class="content-header">
                <div class="content-title">Prescription Payment</div>
                <button class="close-button">Close</button>
            </div>
        </div>



        <div id="reservation-content" class="content-container reservation-container">
            <div class="content-header">
                <div class="content-title">Reservation</div>
                <button class="close-button">Close</button>
            </div>
            <div class="reservation-form">
                <div class="custom-calendar">
                    <div class="calendar-header">
                        <div class="calendar-nav">
                            <button id="prevMonth">&lt; Prev</button>
                        </div>
                        <div class="month-year"></div>
                        <div class="calendar-nav">
                            <button id="nextMonth">Next &gt;</button>
                        </div>
                    </div>
                    <div class="calendar-grid">
                        <div class="weekday">Sun</div>
                        <div class="weekday">Mon</div>
                        <div class="weekday">Tue</div>
                        <div class="weekday">Wed</div>
                        <div class="weekday">Thu</div>
                        <div class="weekday">Fri</div>
                        <div class="weekday">Sat</div>
                    </div>
                </div>
                
                <div class="daily-scheduler">
                    <div class="scheduler-header">
                        <span class="current-date"></span>
                    </div>
                    <div class="time-grid">
                        <!-- 시간대별 행 (JS로 동적 생성) -->
                    </div>
                </div>
            </div>
        </div>



        <!-- Home 컨테이너 추가 -->
        <div id="home-content" class="content-container">
            <div class="content-body">
                <!-- Home 컨텐츠 내용 -->
            </div>
        </div>
    </div>

    <!-- 환자 정보 수정 모달 -->
    <div id="edit-patient-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Edit Patient Information</h3>
                <span class="close-modal">&times;</span>
            </div>
            <div class="modal-body">
                <form id="edit-patient-form">
                    <input type="hidden" id="edit-patient-id">
                    
                    <div class="form-group">
                        <label for="edit-patient-name">Patient Name</label>
                        <input type="text" id="edit-patient-name" class="form-input" required>
                        <span class="error-message" id="edit-name-error"></span>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-id-number">ID Number</label>
                        <input type="text" id="edit-id-number" class="form-input" required>
                        <span class="error-message" id="edit-id-error"></span>
                    </div>
                    
                    <div class="form-group">
                        <label>Gender</label>
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="edit-gender" value="Male"> Male
                            </label>
                            <label>
                                <input type="radio" name="edit-gender" value="Female"> Female
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Date of Birth</label>
                        <div class="date-inputs">
                            <input type="number" id="edit-birth-day" placeholder="Day" min="1" max="31" class="form-input date-input">
                            <input type="number" id="edit-birth-month" placeholder="Month" min="1" max="12" class="form-input date-input">
                            <input type="number" id="edit-birth-year" placeholder="Year" min="1900" max="2100" class="form-input date-input">
                        </div>
                        <span class="error-message" id="edit-birth-error"></span>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-phone">Phone Number</label>
                        <input type="tel" id="edit-phone" class="form-input">
                        <span class="error-message" id="edit-phone-error"></span>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-address">Address</label>
                        <input type="text" id="edit-address" class="form-input">
                    </div>
                    
                    <div class="form-group">
                        <label>Insurance</label>
                        <div class="radio-group">
                            <label>
                                <input type="radio" name="edit-has-insurance" value="yes"> Yes
                            </label>
                            <label>
                                <input type="radio" name="edit-has-insurance" value="no"> No
                            </label>
                        </div>
                    </div>
                    
                    <div id="edit-insurance-details">
                        <div class="form-group">
                            <label for="edit-insurance-provider">Insurance Provider</label>
                            <input type="text" id="edit-insurance-provider" class="form-input">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-insurance-number">Insurance Number</label>
                            <input type="text" id="edit-insurance-number" class="form-input">
                            <span class="error-message" id="edit-insurance-error"></span>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" id="cancel-edit" class="btn btn-secondary">Cancel</button>
                        <button type="submit" id="save-patient" class="btn btn-primary">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 환자 방문 기록 모달 -->
    <div id="view-patient-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Patient Visit History</h3>
                <span id="close-view-modal" class="close">&times;</span>
            </div>
            <div class="modal-body">
                <!-- 환자 기본 정보 요약 -->
                <div class="patient-info-summary" id="view-patient-basic-info">
                    <!-- 환자 정보는 JavaScript에서 동적으로 채워짐 -->
                </div>
                
                <!-- 방문 기록 -->
                <div class="visit-history-container">
                    <div id="visit-history-log">
                        <!-- 방문 기록은 JavaScript에서 동적으로 채워짐 -->
                        <div class="no-visits-message">No visit history found for this patient.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 달력 컨테이너 추가 -->
    <div id="daily-calendar-container" style="display: none;">
        <div class="daily-calendar">
            <!-- 달력은 JavaScript로 동적 생성됨 -->
        </div>
    </div>
</body>
</html>